# GameHub GitHub导入功能规划 V4.0 - 开箱即用版


## 新的目录结构要求

### 核心文件类型
- **`.gamehub`**：链接文件，包含游戏信息和链接
- **`.ico`**：图标文件（可选）
- **`.png`**：背景图片（可选）
- **`gamehub.rule`**：仓库配置文件

### 目录结构
```
根目录/
├── [总文件夹名]/                # 主分类
│   ├── [分类文件夹1]/           # 子分类
│   │   ├── [游戏名].gamehub     # 链接文件
│   │   └── [附件文件夹]/        # 图标和图片
│   │       ├── [文件名].ico     # 图标文件（可选）
│   │       └── [文件名].png     # 背景图片（可选）
└── gamehub.rule                # 仓库配置文件
```

## .gamehub文件格式规范

### 基本格式
```
{
    gamename:[游戏名]|[次级游戏名]
    url:[指向链接]|[指向链接2]
        icon:[icon路径](可选)
        png:[png路径](可选)
}
```

### 分类文件格式
```
{
    gamename:[游戏名]|[次级游戏名]
    url:[指向链接]|[指向链接2]
        icon:[icon路径](可选)
        png:[png路径](可选)
}
{
    gamename:[游戏名]|[次级游戏名]
    url:[指向链接]|[指向链接2]
        icon:[icon路径](可选)
        png:[png路径](可选)
}
```

## GitHub导入策略

### 文件发现规则
1. **主扫描**：递归扫描所有.gamehub文件
2. **关联发现**：自动发现同目录下的.ico/.png文件
3. **配置检查**：验证gamehub.rule文件存在

### 文件过滤策略
- **必需文件**：.gamehub、gamehub.rule
- **可选文件**：.ico、.png、.jpg
- **忽略文件**：所有其他文件类型

### API优化
- **减少调用**：仅获取.gamehub和相关图片文件
- **智能缓存**：缓存.gamehub文件内容和图片文件
- **批量处理**：支持多个.gamehub文件同时处理

## 导入流程

### 1. 仓库验证
- 检查是否为GameHub仓库（gamehub.rule存在且格式正确）
- 验证仓库结构符合规范

### 2. 文件扫描
- 递归扫描所有.gamehub文件
- 收集关联的图标和图片文件路径
- 构建文件映射关系

### 3. 内容解析
- 解析.gamehub文件格式
- 提取游戏名、URL、图标路径、图片路径
- 验证格式正确性

### 4. 资源下载
- 下载图标文件（.ico）
- 下载背景图片（.png/.jpg）
- 保存到本地缓存

### 5. 结构构建
- 根据目录结构创建分类层级
- 关联游戏与图标/图片资源
- 生成导入报告

## 配置文件

### gamehub.rule模板文件
开发者通过克隆仓库获取模板文件，只需修改以下内容即可使用：
```
gamehub:1.0
from:[你的GitHub用户名]
note:[你的仓库描述]
```




## 错误处理

### 文件错误
- **格式错误**：标记具体.gamehub文件和错误位置
- **缺失文件**：记录缺失的图标或图片文件
- **路径错误**：提供正确的相对路径建议

### 网络错误
- **下载失败**：重试机制和备用方案
- **API限制**：智能限速和缓存策略
- **认证失败**：提供GitHub Token配置指导

## 性能优化

### 缓存策略
- **文件缓存**：缓存已下载的图标和图片
- **API缓存**：缓存GitHub API响应
- **格式缓存**：缓存验证通过的.gamehub文件

### 并发控制
- **并发下载**：限制同时下载的文件数量
- **API限速**：遵守GitHub API限制
- **内存管理**：分批处理大文件

## 扩展功能

#### 模板工具
- 提供gamehub.rule模板文件
- 格式检查：自动验证.gamehub文件格式
- 错误提示：当格式错误时给出具体修正建议

## 兼容性说明
- **文件编码**：支持UTF-8编码的.gamehub文件
- **图片格式**：支持.ico、.png、.jpg格式
- **路径格式**：支持Windows和Unix路径分隔符
- **大小限制**：单个文件最大100MB（GitHub限制）